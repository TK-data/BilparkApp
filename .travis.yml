language: node_js
node_js:
  - "node"

cache: yarn

before_install:
  - cd BilparkApp
  - cd src
  - cd config
  - cp connections.js.example connections.js
  - cd ..
  - cd ..

before_script:
  - npm install

install:
  npm install -g codecov

script:
  - npm test
  - 'if [ "$TRAVIS_PULL_REQUEST" != "false" ]; then yarn appr; fi'

deploy:
  - cd ..
  - cd Backend
  - provider: heroku
    api_key: $HEROKU_AUTH_TOKEN
    app:
      dev: tkdata15-backend-dev
      master: tkdata15-backend-prod

after_success:
  - bash <(curl -s https://codecov.io/bash)

notifications:
  email: false
  slack:
    rooms:
      - bachelor-it2901:GvHs8vnnvxJB8Rfb78EuRnJ8#travis
